// OTAKU CITY - MINIFIED JAVASCRIPT
function scrollToProducts(e){e.preventDefault();const t=document.getElementById("products");t&&t.scrollIntoView({behavior:"smooth",block:"start"})}class VideoPopup{constructor(){this.helpButton=document.getElementById("helpButton"),this.videoPopup=document.getElementById("videoPopup"),this.closePopup=document.getElementById("closePopup"),this.popupVideo=document.getElementById("popupVideo"),this.videoUrl="https://player.vimeo.com/video/1098854357?autoplay=1&title=0&byline=0&portrait=0&controls=1",this.init()}init(){this.helpButton&&this.videoPopup&&this.closePopup&&this.popupVideo?this.bindEvents():console.error("VideoPopup elements not found")}bindEvents(){this.helpButton.addEventListener("click",(e=>{e.preventDefault(),this.openPopup()})),this.closePopup.addEventListener("click",(e=>{e.preventDefault(),this.closePopupHandler()})),this.videoPopup.addEventListener("click",(e=>{e.target===this.videoPopup&&this.closePopupHandler()})),document.addEventListener("keydown",(e=>{"Escape"===e.key&&this.videoPopup.classList.contains("active")&&this.closePopupHandler()}))}openPopup(){this.popupVideo.src=this.videoUrl,this.videoPopup.classList.add("active"),document.body.style.overflow="hidden"}closePopupHandler(){this.videoPopup.classList.remove("active"),this.popupVideo.src="",document.body.style.overflow=""}}class ImageCarousel{constructor(){if(this.carouselTrack=document.getElementById("carouselTrack"),this.prevBtn=document.getElementById("prevBtn"),this.nextBtn=document.getElementById("nextBtn"),this.carouselIndicators=document.getElementById("carouselIndicators"),!this.carouselTrack||!this.prevBtn||!this.nextBtn||!this.carouselIndicators)return;if(this.slides=Array.from(this.carouselTrack.children),0===this.slides.length)return;this.slideWidth=this.slides[0].offsetWidth,this.currentIndex=0,this.intervalTime=4e3,this.autoSlideInterval=null,this.init()}init(){this.createIndicators(),this.updateIndicators(),this.setupEventListeners(),this.startAutoSlide(),this.adjustSlideWidth(),window.addEventListener("resize",this.adjustSlideWidth.bind(this))}adjustSlideWidth(){0!==this.slides.length&&(this.slideWidth=this.slides[0].offsetWidth,this.moveToSlide(this.currentIndex,!1))}createIndicators(){this.slides.forEach(((e,t)=>{const i=document.createElement("div");i.classList.add("carousel-indicator"),0===t&&i.classList.add("active"),i.addEventListener("click",(()=>{this.moveToSlide(t),this.resetAutoSlide()})),this.carouselIndicators.appendChild(i)}))}updateIndicators(){Array.from(this.carouselIndicators.children).forEach(((e,t)=>{t===this.currentIndex?e.classList.add("active"):e.classList.remove("active")}))}moveToSlide(e,t=!0){e<0?this.currentIndex=this.slides.length-1:e>=this.slides.length?this.currentIndex=0:this.currentIndex=e;const i=-this.currentIndex*this.slideWidth;this.carouselTrack.style.transition=t?"transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)":"none",this.carouselTrack.style.transform=`translateX(${i}px)`,this.updateIndicators()}nextSlide(){this.moveToSlide(this.currentIndex+1)}prevSlide(){this.moveToSlide(this.currentIndex-1)}startAutoSlide(){this.autoSlideInterval=setInterval((()=>{this.nextSlide()}),this.intervalTime)}resetAutoSlide(){clearInterval(this.autoSlideInterval),this.startAutoSlide()}setupEventListeners(){this.nextBtn.addEventListener("click",(()=>{this.nextSlide(),this.resetAutoSlide()})),this.prevBtn.addEventListener("click",(()=>{this.prevSlide(),this.resetAutoSlide()})),this.carouselTrack.addEventListener("mouseenter",(()=>clearInterval(this.autoSlideInterval))),this.carouselTrack.addEventListener("mouseleave",(()=>this.startAutoSlide()))}}class OnePieceGallery{constructor(){this.images=["https://i.ibb.co/ksbt0y0w/OP-1.jpg","https://i.ibb.co/xSmzBw27/OP-2.jpg","https://i.ibb.co/jScdwdG/OP-3.jpg","https://i.ibb.co/S7Mt7QYb/OP-4.jpg","https://i.ibb.co/4g0gZMp8/OP-5.jpg","https://i.ibb.co/RpncjJ3P/OP-6.jpg","https://i.ibb.co/n8g8z1bt/OP-7.jpg","https://i.ibb.co/KzWvYhhC/OP-8.jpg","https://i.ibb.co/ZpsDvJGC/OP-9.jpg","https://i.ibb.co/sppZsTZY/OP-10.jpg","https://i.ibb.co/xqHNtpj5/OP-11.jpg","https://i.ibb.co/m5BW96Wq/OP-12.jpg","https://i.ibb.co/kVhP5X4V/OP-13.jpg","https://i.ibb.co/6dLqbtR/OP-14.jpg","https://i.ibb.co/Kjdq2jXj/OP-15.jpg","https://i.ibb.co/p6vd5bkj/OP-16.jpg","https://i.ibb.co/pvYWCfwd/OP-17.jpg","https://i.ibb.co/fzZV51VM/OP-18.jpg","https://i.ibb.co/FLnXhTsH/OP-19.jpg","https://i.ibb.co/Vcg3VvnT/OP-20.jpg","https://i.ibb.co/Z6pr2szn/OP-21.jpg","https://i.ibb.co/Jj9PrTZL/OP-22.jpg","https://i.ibb.co/W4t13QbJ/OP-23.jpg","https://i.ibb.co/LDsq8F8M/OP-24.jpg","https://i.ibb.co/SwnK28n4/OP-25.jpg","https://i.ibb.co/bMkJgRDM/OP-26.jpg","https://i.ibb.co/8LN9qZyH/OP-27.jpg","https://i.ibb.co/RFXRBm8/OP-28.jpg","https://i.ibb.co/zVdypxFp/OP-29.jpg","https://i.ibb.co/BVCWVXZX/OP-30.jpg","https://i.ibb.co/3ysQZTbq/OP-31.jpg","https://i.ibb.co/4gVYfBRB/OP-32.jpg","https://i.ibb.co/wN8Q1NSX/OP-33.jpg","https://i.ibb.co/5h0TCP6H/OP-34.jpg","https://i.ibb.co/zV7WZDvj/OP-35.jpg","https://i.ibb.co/S4HjfL6X/OP-36.jpg","https://i.ibb.co/v4K6RssB/OP-37.jpg","https://i.ibb.co/fzWc1Rdg/OP-38.jpg","https://i.ibb.co/b51pjL5Q/OP-39.jpg","https://i.ibb.co/PzQNdBnQ/OP-40.jpg","https://i.ibb.co/4ZC9tLys/OP-41.jpg","https://i.ibb.co/1Yz0m5hp/OP-42.jpg","https://i.ibb.co/4wrSrCM3/OP-43.jpg","https://i.ibb.co/3YCXxWLS/OP-45.jpg","https://i.ibb.co/RLkHL4J/OP-46.jpg","https://i.ibb.co/m5Rfb6B2/OP-47.jpg","https://i.ibb.co/C5bFfhS7/OP-48.jpg","https://i.ibb.co/vxVgK7Zz/OP-49.jpg","https://i.ibb.co/1JYL5Btk/OP-50.jpg","https://i.ibb.co/C3Czq8fC/OP-51.jpg","https://i.ibb.co/JwP6pZR5/OP-52.jpg","https://i.ibb.co/nNgVNSCy/OP-53.jpg","https://i.ibb.co/v6FBtyKm/OP-54.jpg","https://i.ibb.co/JRPnT3LY/OP-55.jpg","https://i.ibb.co/spQCZvmv/OP-56.jpg","https://i.ibb.co/0psSbdQD/OP-57.jpg"],this.imageCache=new Map,this.preloadedImages=new Set,this.galleryGrid=document.getElementById("galleryGrid"),this.galleryGrid&&this.init()}init(){this.createGalleryItems(),setTimeout((()=>{this.imagePopup=new ImagePopup}),500),this.startBackgroundPreload()}preloadImage(e){return new Promise(((t,i)=>{if(this.imageCache.has(e))return void t(this.imageCache.get(e));const s=new Image;s.onload=()=>{this.imageCache.set(e,s),this.preloadedImages.add(e),t(s)},s.onerror=i,s.src=e}))}startBackgroundPreload(){setTimeout((()=>{this.images.forEach(((e,t)=>{this.preloadedImages.has(e)||setTimeout((()=>{this.preloadImage(e)}),100*t)}))}),1e3)}createGalleryItems(){this.images.forEach(((e,t)=>{const i=document.createElement("div");i.className="onepiece-gallery-item",i.dataset.index=t;const s=document.createElement("img");s.src=e,s.loading="lazy",s.alt=`One Piece - Placa decorativa ${t+1}`,s.width="280",s.height="400";const o=document.createElement("button");o.className="onepiece-gallery-btn",o.textContent="💬 Quero Esta",o.dataset.imageUrl=e,o.dataset.imageIndex=t+1,o.addEventListener("click",(()=>{this.sendWhatsAppMessage(e,t+1)})),i.appendChild(s),i.appendChild(o),this.galleryGrid.appendChild(i)}))}sendWhatsAppMessage(e,t){const i=`🏴‍☠️ Olá! Quero esta placa do One Piece (#${t}): ${e}`,s=`https://wa.me/5511958588616?text=${encodeURIComponent(i)}`;window.open(s,"_blank")}}class ImagePopup{constructor(){this.imagePopup=document.getElementById("imagePopup"),this.closeImagePopup=document.getElementById("closeImagePopup"),this.popupImage=document.getElementById("popupImage"),this.imagePopup&&this.closeImagePopup&&this.popupImage&&this.init()}init(){this.setupEventListeners(),this.setupImageClickListeners()}setupEventListeners(){this.closeImagePopup.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),this.closePopup()})),this.closeImagePopup.addEventListener("touchend",(e=>{e.preventDefault(),e.stopPropagation(),this.closePopup()})),this.imagePopup.addEventListener("click",(e=>{e.target===this.imagePopup&&this.closePopup()})),document.addEventListener("keydown",(e=>{"Escape"===e.key&&this.imagePopup.classList.contains("active")&&this.closePopup()})),this.popupImage.addEventListener("click",(e=>{e.stopPropagation()})),this.popupImage.addEventListener("touchend",(e=>{e.stopPropagation()}))}setupImageClickListeners(){setTimeout((()=>{const e=document.querySelectorAll(".onepiece-gallery-item img");e.forEach(((e,t)=>{let i,s,o,n=0,a=0,l=0;const r=t=>{a=t.touches[0].clientY,n=t.touches[0].clientX,l=Date.now(),o=!1},c=e=>{if(!e.touches[0])return;const t=e.touches[0].clientY,i=e.touches[0].clientX,s=Math.abs(t-a),l=Math.abs(i-n);(s>10||l>10)&&(o=!0)};i=t=>{t.preventDefault(),t.stopPropagation(),this.openPopup(e.src,e.alt)},s=t=>{const i=Date.now()-l;!o&&i<500&&i>50?(t.preventDefault(),t.stopPropagation(),this.openPopup(e.src,e.alt)):console.log(`Touch ignored - movement: ${o}, duration: ${i}ms`)},e.addEventListener("click",i),e.addEventListener("touchstart",r,{passive:!0}),e.addEventListener("touchmove",c,{passive:!0}),e.addEventListener("touchend",s,{passive:!1}),e.addEventListener("keydown",(t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),this.openPopup(e.src,e.alt))})),e.setAttribute("tabindex","0"),e.style.cursor="pointer",e.style.touchAction="manipulation",e.style.userSelect="none",e.style.webkitUserSelect="none"}))}),500)}openPopup(e,t){this.popupImage.src=e,this.popupImage.alt=t||"Visualização da imagem",this.imagePopup.classList.add("active"),document.body.style.overflow="hidden",setTimeout((()=>{this.closeImagePopup.focus()}),100)}closePopup(){this.imagePopup.classList.remove("active"),setTimeout((()=>{this.popupImage.src="",this.popupImage.alt=""}),300),document.body.style.overflow=""}}document.addEventListener("DOMContentLoaded",(()=>{new VideoPopup,new ImageCarousel,document.getElementById("galleryGrid")?new OnePieceGallery:new ImagePopup})),function smoothScrollTo(e){const t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth",block:"start"})}function goBack(){window.history.length>1?window.history.back():window.location.href="/"}function isMobile(){return window.innerWidth<=768}function optimizeForMobile(){if(isMobile()){document.documentElement.style.setProperty("--animation-duration","0.2s");const e=document.createElement("style");e.textContent="\n            @media (hover: none) {\n                .carousel-item:hover,\n                .cta-button:hover,\n                .whatsapp-button:hover {\n                    transform: none !important;\n                }\n            }\n        ",document.head.appendChild(e)}}window.addEventListener("load",(()=>{optimizeForMobile();["https://i.ibb.co/5fx7ydb/OC.png","https://i.ibb.co/y3wvPbx/OCT.png"].forEach((e=>{const t=new Image;t.src=e}))})),function setupLazyLoading(){const e=document.querySelectorAll('img[loading="lazy"]');if("IntersectionObserver"in window){const t=new IntersectionObserver(((e,i)=>{e.forEach((e=>{if(e.isIntersecting){const s=e.target;s.src=s.dataset.src||s.src,s.classList.remove("lazy"),i.unobserve(s)}}))}));e.forEach((e=>t.observe(e)))}}document.addEventListener("DOMContentLoaded",setupLazyLoading);